<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Condition Monitor</title>
  <meta http-equiv="refresh" content="5">
  <style>
    body { background-color: black !important; color: white; margin: 0; overflow: hidden; font-family: 'Pretendard', sans-serif; }
    .top-bar { display: flex; justify-content: space-between; padding: 20px; border-bottom: 1px solid #333; color: #888; }
    .user-badge { background-color: #3498db; color: white; padding: 5px 15px; border-radius: 20px; font-weight: bold; }
    
    .main-container { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 85vh; }
    
    /* ì¹´ë©”ë¼ í”¼ë“œ ìŠ¤íƒ€ì¼ */
    .video-container { width: 800px; height: 450px; border: 4px solid #444; border-radius: 30px; overflow: hidden; box-shadow: 0 0 50px rgba(255,255,255,0.05); }
    .video-feed { width: 100%; height: 100%; object-fit: cover; }

    /* í”¼ë¡œë„ ìˆ˜ì¹˜ ì „ê´‘íŒ */
    .status-panel { margin-top: 40px; text-align: center; }
    .status-label { font-size: 24px; color: #aaa; margin-bottom: 10px; }
    .status-value { font-size: 110px; font-weight: 900; text-transform: uppercase; margin: 0; }
    
    .details { display: flex; gap: 60px; margin-top: 25px; }
    .detail-item { text-align: center; }
    .detail-label { color: #666; font-size: 16px; margin-bottom: 5px; }
    .detail-num { font-size: 36px; font-weight: 600; }

    /* ìƒíƒœë³„ ìƒ‰ìƒ ì ìš© */
    .normal { color: #2ed573; }
    .drowsy { color: #ff4757; animation: blink 1s infinite; }
    @keyframes blink { 50% { opacity: 0.5; } }
  </style>
</head>
<body>

  <div class="top-bar">
    <div>Monitor Â· {{ now }}</div>
    {% if current_user != 'Unknown' %}
      <div class="user-badge">ğŸ‘¤ {{ current_user }}ë‹˜</div>
    {% endif %}
  </div>

  <div class="main-container">
    <div class="video-container">
      <img src="{{ url_for('video_feed') }}" class="video-feed">
    </div>

    <div class="status-panel">
      {% if current_user == 'Unknown' %}
        <div class="status-value" style="font-size: 50px; color: #444;">SEARCHING...</div>
        <div class="status-label">ê±°ìš¸ ì• ì •ë©´ì„ ì‘ì‹œí•´ ì£¼ì„¸ìš”</div>
      {% else %}
        <div class="status-label">í˜„ì¬ ì»¨ë””ì…˜ ìƒíƒœ</div>
        <div class="status-value {{ 'drowsy' if cond.state == 'drowsy' else 'normal' }}">
          {{ cond.state }}
        </div>
        
        <div class="details">
          <div class="detail-item">
            <div class="detail-label">ëˆˆ ê¹œë¹¡ì„(ë¶„)</div>
            <div class="detail-num">{{ cond.blink_per_min|round(1) }}íšŒ</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">ëˆˆ ê°ìŒ ë¹„ìœ¨(10s)</div>
            <div class="detail-num">{{ (cond.closed_ratio_10s * 100)|round(1) }}%</div>
          </div>
        </div>
      {% endif %}
    </div>
  </div>

</body>
</html>